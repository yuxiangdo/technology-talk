主要问基础，包括几方面:

1) collection接口下面有哪些集合，
collection和Map接口，collection下有Set、Queue、List
hashmap的实现原理，要把1.7和1.8的区别(红黑树)讲出来，
map有哪些实现类以及使用场景，hashmap, hashtable, linkedhashmap,weakHashMap,treemap,concurrentmap，linkedhashmap和treemap排序的区别，concurrenthashmap如何实现线程安全，这里也要把1.7和1.8实现差异说出来(分段加锁和cas技术)，说到这里以后就会问你cas实现原理( CPU Lock前缀指令),它是如何保证其他cpu core的cache失效的，然后会问你volatile的实现原理，要结合java内存模型来讲，可见性是如何实现的(内存屏障)，synchronized锁和reentrantlock的区别以及内部怎么实现的:常用的gc算法及优缺点，如何判断对象的存活性



2) mysql有哪些索引，底层数据结构是什么，画一下b+树的结构以及数据的插入过程，聚集索引的特点，如何做索引优化，给你一个sql语句select a,b,c from t where a<某个值 and b>某个值 and c = 1,如何建索引(可以是c,a,b或者c,b, a的联合索引，但要分析什么场景下分别用哪个);结合Innodb的实现说下数据库的隔离级别，分别是怎么解决脏读、不可重复读和幻读取的;对mysql最新版本的同步机制有没有了解,比如一个主节点和多个备份节点,mysql怎么保证可用性和性能；

---------
索引不可能全部存储在内存，是以索引文件的形式存储在磁盘上，索引查找过程中就要产生磁盘IO消耗，内存存取高于磁盘，所以索引的优劣重要是查找过程中磁盘IO操作次数的渐进复杂度。

聚集索引：索引中键值的逻辑顺序决定了表中相应行的物理顺序，叶节点是数据节点，而非聚集索引的叶节点仍然是索引节点，不过有一个指针对应的数据块。（InnorDB聚集索引、MyISAM是非聚集索引）

联合索引：命名规则：表名_字段名 1.需要加索引的字段要在where条件中；数据量少的字段不需要加索引；如果where条件中是or关系，加索引不起作用；符合最左原则：如索引key index（a，b，c），可以支持a、ab、abc3种组合进行查找，当最左侧字段是常量引用时索引就十分有效。

唯一索引、主键索引
设计索引：对查询占主要的应用建索引、复合索引满足最佳左前缀特性、索引不会包含含有NULL值的列、like %aa% 不会使用索引，而like aa% 可以使用索引

数据库的隔离级别：读未提交、读提交、重复读（mysql默认级别）、序列化
脏读：事务A读取了事务B修改但未提交的数据，如果事务B回退则A读取的数据无效。
不可重复读：读时加锁或使用多版本控制协议，重点是修改，同样的条件，读取出的数据，再次读取出来的数据不一样
幻读：重点是新增或删除数据记录，读取的数据量不一样

3) redis有哪些数据结构，分别用在哪些场景,对redis的pipeline有没有了解，解决什么问题,redis采用了什么方式来节省内存
String 动态字符串
append（追加后value的长度）、incr（指定key的value值递增1，如果key不存在则先初始化为0后增加1）、incrby、decr、decrby、set（ok）、get（如果key不存在则返回nil）
Hash
List
Set
Sorted Set


4) Spring IOC的理解以及IOC容器的初始化过程,Spring里的Bean是保存在哪里的,BeanFactory和FactoryBean的区别,Spring AOP怎么实现的(需要讲出来JDK动态代理和CGLib动态代理优缺点),头条还问了如果一个类的某个方法没有在接口里定义,这两种动态代理方式是怎么实现的；

Inversion of Control 控制反转，把业务对象的控制权交给一个平台或框架，同一管理的平台称为Ioc容器。两类主要容器：实现BeanFactory接口的简单容器、实现ApplicationContext接口的高级容器


5) 线程池有哪些实现类，ThreadPoolExecutor有哪些参数，讲下它的工作原理，在使用过程中有哪些经验(比如工作队列大小的设置,ThreadFactory和ExjectExcutionHandler)

6) 线程有哪些状态以及怎么转换的

2. 二面主要结合项目来问

1). GC的常用算法以及优缺点，项目中用的什么垃圾回收算法,怎么做GC调优,对G1收集器有没有了解(要说出G1的出现主要解决了什么问题,为什么CMS算法会有内存碎片)

在介绍GC算法的时候可能会提到GC Roots，面试官会问你哪些对象可以作为GC Roots，栈里面的局部变量表里有基本数据类型和引用类型，怎么找到引用类型;有个对象引用比如Hello,hello.sayHello()调用的时候怎么找到类里的sayHello()这个方法

2). 项目里有用到限流，具体怎么做的

3). 看你对Netty有了解，能不能讲下它的工作原理,netty里ChannelInBoundHandler和ChannelOutBoundHandler的区别，netty在读写数据的时候是先调用head还是tail handler,既然你知道NIO，有没有听说

JDK epoll的BUG，Netty是怎么解决的,如何解决TCP粘包和拆包的问题,为什么会出现粘包和拆包
Linux网络IO模型 5种IO模型
1、阻塞IO模型：进程空间调用recvfrom，系统调用直到数据包到达且被复制到应用进程的缓冲区中或发生错误时才返回，在此期间一直等待
2、非阻塞IO模型：recvfrom从应用层到内核的时候，如果该缓冲区没有数据的话直接返回EWOULDBLOCK错误，轮询检查状态看内核是否有数据到来
3、IO复用模型：select/poll，通过将fd传递给select/poll系统调用，可以侦测多个fd是否就绪，顺序扫描，支持的fd数量有限。epoll使用基于事件驱动方式代替顺序扫描，性能更高
4、信号驱动IO模型：开启信号驱动IO功能，并通过系统调用sigaction执行信号处理函数，当书记准备就绪是，为进程生成sigio信号，通过信号回调通知应用程序取数据
5、异步IO：告知内核启动某个操作，并让内核在整个操作完成后通知（包括数据从内核复制到用户的缓冲区）

epoll改进点：支持一个进程打开的socket描述符fd不受限制（仅受操作系统最大文件句柄数）；IO效率不会随FD数目增加而线性下降；使用mmap加速内核与用户空间的消息传递；epoll的API更加简单

4). 讲下你项目里做的数据库索引优化,如何去分析一条语句的执行性能,explain语句你会关注哪些字段

5). 分别在什么场景使用synchronized和Lock，ReentrantLock内部怎么实现的，多线程通信有哪些方式(要把JUC包下的常用实现类说出来,比如CountDownLantch,信号量,栅栏)

6). 如何实现分布式锁,一开始说了redis的实现,redis可能在锁超时后还没执行完任务,这个时候要怎么做，有没有更好的方式,后面说了用zookeeper的实现

7). 项目里有用到ElasticSearch，能介绍ES的工作原理吗,什么是正向索引和反向索引，如何对ES进行优化

8). 为什么会出现大量CLOSE_WAIT连接，能不能画一下TCP挥手的流程图介绍下,后面是怎么解决句柄泄露的问题

9). 写代码实现一个EnumSet(阿里),用数组或者链表实现一个阻塞队列(美团)

10). 哪些场景下会出现内存泄露(可以讲下HashMap,ThreadLocal,WeakHashMap,finalize),会问你ThreadLocal的原理以及为什么会有内存泄露

11). 如何获取Redis里所有的keys(可以先说下keys *命令,然后再介绍可能导致系统阻塞无法对外响应,再介绍更好的scan命令)

12). Java类加载机制，为什么要双亲委派

13). Spring Bean的作用域有哪些，单例是线程安全的吗，怎么保证线程安全

14). java里的Exception信息是怎么保存的,有没有用到java8的一些特性,Lambda表达式是语法糖吗，怎么实现的，和匿名内部类有什么区别;

3. 三面,一般是技术总监或者某个部门的主管面

1). 简历里有提到有定位系统响应慢的经验，具体怎么做的

2). 如果有个节点一直在做FullGC，你要怎么快速定位并恢复环境

3). 如果要做一个秒杀系统，你会怎么设计，把能想到的点都说出来

4). 假设数据库里有100W条数据，要把他们全部加载到Redis里，你会怎么设计这个系统(这里可能是个坑,缓存一般保存的热点数据,要讲下分布式缓存、缓存击穿、雪崩、并发更新等问题)

5). ElasticSearch的分片机制,ES搜索过程是如何工作的,如果有很多网卡信息怎么做分片，如果一个Document有2个网卡呢

6). 用过哪些消息中间件,能不能说下Kafka的工作原理，如果保证分布式系统的数据的一致性,给Kafka发消息如何保证消息的幂等性

7). 如何对数据库做分库分表

4. 四面,基本上也是结合项目来问一些知识点,面试官一般会比较强势,会经常打断你说话,给你压力,这个时候千万不要慌,问的问题和上面差不多

你在项目中遇到的最难的一个问题是什么，自己对未来3-5年的一个规划



Spring加载过程
AOP的好处
容器IOC的好处
mysql对行锁定后，其他要对行锁定时，会发生什么？
如果得不到锁就直接返回
redis的高可用，主从复制，哨兵机制


